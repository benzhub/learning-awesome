# Codebase Indexing 最佳實踐

## ✅ 推薦做法
### 做法 1：固定提問模板
先寫目標、再寫範圍、最後寫輸出格式，能穩定提升結果可用性。

```text
@Codebase
目標：找出「退款失敗」的處理路徑
範圍：API、Service、Repository、Error Handler
輸出：條列檔案路徑 + 關鍵函式 + 1 句作用說明
```

### 做法 2：兩階段查詢
第一輪用 `@Codebase` 找全局路徑；第二輪改用 `@檔案` 深入解析與修改建議。

```text
# 第一輪
@Codebase 找出優惠券套用流程與驗證邏輯。

# 第二輪
@src/services/coupon.service.ts
請重構這段驗證流程，降低重複邏輯。
```

### 做法 3：把回答轉成「可驗證清單」
要求 AI 附上「可能遺漏點」與「你下一步要驗證的檔案」，避免過度相信單次回答。

## ❌ 常見錯誤
### 錯誤 1：把 `@Codebase` 當成萬能答案
**問題**：一次問太大，得到空泛結果。  
**原因**：語義召回需要可聚焦的任務描述。  
**修正**：一次只問一條業務流程，逐步追問。

### 錯誤 2：只看路徑，不看實際程式碼
**問題**：AI 指到檔案，但你沒驗證就直接改。  
**原因**：召回是候選，不保證 100% 精準。  
**修正**：切到 `@檔案` 讀關鍵函式後再動手。

### 錯誤 3：索引異常時持續硬問
**問題**：答案反覆偏題。  
**原因**：索引可能不同步或上下文污染。  
**修正**：先縮小問題、開新對話，必要時手動 Sync 或重建索引。

## 自我檢查清單
- 我的問題有明確目標嗎？
- 我有指定範圍嗎（流程/模組/層級）？
- 我有要求固定輸出格式嗎？
- 我有在第二輪用 `@檔案` 驗證嗎？

## 下一步
回到你的專案，選一條真實流程（例如登入或下單），用本系列模板完整跑一次。你會很快建立自己的高命中提問庫。
