# å¸¸è¦‹ä½¿ç”¨æ¨¡å¼

## Pattern 1ï¼šå‚™ä»½è™›æ“¬æ©Ÿ

**å•é¡Œ**ï¼šå®šæœŸå‚™ä»½ VMï¼Œé¿å…è³‡æ–™éºå¤±ã€‚

**è§£æ³•**ï¼šä½¿ç”¨å…§å»ºå‚™ä»½ä»»å‹™ã€‚

```bash
# æ‰‹å‹•å‚™ä»½ VM 100 åˆ° local å­˜å„²
vzdump 100 --storage local --mode snapshot --compress zstd

# æˆ–é€é Webï¼šé¸ VM â†’ Backup â†’ Backup now
```

**æ’ç¨‹å‚™ä»½**ï¼š  
è³‡æ–™ä¸­å¿ƒ â†’ Backup â†’ Add â†’ é¸æ“‡ VMã€å­˜å„²ã€æ™‚é–“ï¼ˆå¦‚æ¯å¤© 2:00ï¼‰ã€‚

> ğŸ’¡ `snapshot` æ¨¡å¼å¯å‚™ä»½é‹è¡Œä¸­çš„ VMï¼Œç„¡éœ€é—œæ©Ÿã€‚

---

## Pattern 2ï¼šå…‹éš†è™›æ“¬æ©Ÿ

**å•é¡Œ**ï¼šè¤‡è£½ç¾æœ‰ VM å»ºç«‹æ–°ç’°å¢ƒã€‚

**è§£æ³•**ï¼šå®Œæ•´å…‹éš†æˆ–é€£çµå…‹éš†ã€‚

```bash
# å®Œæ•´å…‹éš†ï¼ˆç¨ç«‹ç£ç¢Ÿï¼‰
qm clone 100 101 --name clone-vm --full

# é€£çµå…‹éš†ï¼ˆå…±ç”¨åŸºç¤ç£ç¢Ÿï¼Œè¼ƒçœç©ºé–“ï¼‰
qm clone 100 101 --name linked-clone --linked
```

**Web æ“ä½œ**ï¼šé¸ VM â†’ More â†’ Cloneã€‚

**å·®ç•°**ï¼šå®Œæ•´å…‹éš†å¯ç¨ç«‹é·ç§»ï¼›é€£çµå…‹éš†ä¾è³´åŸºç¤ç£ç¢Ÿï¼Œè¼ƒçœç©ºé–“ã€‚

---

## Pattern 3ï¼šç·šä¸Šé·ç§»ï¼ˆLive Migrationï¼‰

**å•é¡Œ**ï¼šVM ä¸é—œæ©Ÿï¼Œå¾ç¯€é» A æ¬åˆ°ç¯€é» Bã€‚

**å‰ç½®**ï¼šVM ç£ç¢Ÿåœ¨å…±äº«å­˜å„²ï¼ˆNFSã€Ceph ç­‰ï¼‰ï¼Œæˆ–å…©ç¯€é»éƒ½èƒ½å­˜å–åŒä¸€å­˜å„²ã€‚

**è§£æ³•**ï¼š

```bash
# å‘½ä»¤åˆ—é·ç§»
qm migrate 100 <ç›®æ¨™ç¯€é»> --live

# Webï¼šé¸ VM â†’ Migrate â†’ é¸ç¯€é» â†’ Migrate
```

> âš ï¸ è‹¥ç£ç¢Ÿåœ¨ localï¼Œéœ€å…ˆé·ç§»ç£ç¢Ÿæˆ–ä½¿ç”¨å…±äº«å­˜å„²ã€‚

---

## Pattern 4ï¼šå»ºç«‹ LXC å®¹å™¨

**å•é¡Œ**ï¼šå¿«é€Ÿéƒ¨ç½²è¼•é‡ Linux ç’°å¢ƒã€‚

**è§£æ³•**ï¼šä½¿ç”¨å…§å»ºæ¨¡æ¿ã€‚

```bash
# ä¸‹è¼‰ç¯„æœ¬ï¼ˆè‹¥å°šæœªä¸‹è¼‰ï¼‰
pveam update
pveam download local debian-12-standard_12.2-1_amd64.tar.zst

# å»ºç«‹å®¹å™¨
pct create 200 local:vztmpl/debian-12-standard_12.2-1_amd64.tar.zst \
  --hostname my-app \
  --memory 512 \
  --cores 1 \
  --net0 name=eth0,bridge=vmbr0,ip=dhcp \
  --rootfs local-lvm:8
```

**Web æ“ä½œ**ï¼šå³ä¸Šè§’ Create CT â†’ é¸æ¨¡æ¿ã€è¨­å®šè³‡æºå³å¯ã€‚

---

## Pattern 5ï¼šå¿«ç…§èˆ‡é‚„åŸ

**å•é¡Œ**ï¼šæ›´æ–°å‰åšå¿«ç…§ï¼Œå‡ºå•é¡Œå¯é‚„åŸã€‚

```bash
# å»ºç«‹å¿«ç…§
qm snapshot 100 before-update

# é‚„åŸ
qm rollback 100 before-update

# åˆªé™¤å¿«ç…§
qm delsnapshot 100 before-update
```

**Web**ï¼šé¸ VM â†’ Snapshots â†’ Take snapshotã€‚

## ä¸‹ä¸€æ­¥

é›†ç¾¤ã€HAã€Ceph éƒ¨ç½² â†’ [é€²éšç”¨æ³•](04-advanced.md)
